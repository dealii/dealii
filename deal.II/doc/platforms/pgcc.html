<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN"
   "http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
  <head>
    <link href="../screen.css" rel="StyleSheet" media="screen">
    <link href="../print.css" rel="StyleSheet" media="print">
    <title>The deal.II Readme -- Installation Instructions</title>
    <meta name="author" content="Wolfgang Bangerth <deal@iwr.uni-heidelberg.de>">
    <meta name="keywords" content="deal.II">
  </head>

  <body>


    <h1>Installation instructions for the Portland Group pgcc compiler</h1>

    <p>
    This compiler is not supported yet, or maybe we should say this
    differently: this compiler does not support C++ enough to allow
    compilation of the library. The first obstacle is that as of
    version 3.3-2, the compiler does not come with C++ style headers
    <code>&lt;cmath&rt;</code>, <code>&lt;cstdlib&rt;</code>, etc. If
    such a file is placed into the respective include directory,
    containing in include statement for the respective C style header
    (no "c" in front, but a ".h" at the end), then at least the
    preprocessor works, but we are stuck with uses of the math
    functions in namespace "std", such as <code>std::sin</code>. This
    would require changes all over the code, or writing a standard
    compliant header file, both of which we are not willing to do as
    this is just a lack of C++ conformance of the compiler, not of the
    library.
    </p>

    <p>
    However, even if we do this in a couple of places, we get
    consistent errors with this perfectly legal piece of code:
    <code>
    <pre>
#include <map>

void g (double);
void f() 
{
  std::map<int,double> m;
  for (std::map<int,double>::const_iterator i=m.begin(); i!=m.end(); ++i)
    g(i->second);
};
    </pre>
    </code>
    leading to this message:
    <code>
    <pre>
tmp/x> pgCC -c x.cc
"x.cc", line 8: error: expression must have pointer type
      g(i->second);
        ^

1 error detected in the compilation of "x.cc".
    </pre>
    </code>
    </p>

    <p>
    Furthermore, we consistently got this error:
    <code>
    <pre>
"/home/wolf/p/deal.II/3/deal.II/base/include/base/memory_consumption.h", line 482: internal error:
          assertion failed at: "../src/types.c", line 4669

    unsigned int memory_consumption (const T (&v)[N])
                 ^

1 catastrophic error detected in the compilation of "source/data_out_base.cc".
Compilation aborted.
pgCC-Fatal-/home/wolf/bin/pgcc/linux86/bin/pgcpp1 TERMINATED by signal 6
    </pre>
    </code>
    At this point we thought we'd better use our time for something
    better and wait for the next version of the compiler.
    </p>


    <p>
    When the next version came (4.0), we found the front-end much
    improved. However, the real showstopper is that for this code
    <code>
    <pre>
    template &lt;int dim&gt; struct C {
      void f();
    };

    template &lt;&gt; void C&lt;1&gt;::f() {};
    </pre>
    </code>
    no code is generated for <code>C&lt1&gt::f</code> unless the
    function is used later on in the file. In contrast to
    non-specialized template functions, this case is also not handled
    by pgcc's prelinker which would otherwise instantiate missing
    templates. Since we have many (many many) specializations of
    member functions in the .cc files in the library, that means that
    code for these functions is never generated. Consequently, one
    gets linker errors later on.
    </p>

    <p>
    We believe that pgcc's behavior is not in accordance with the
    standards, and is also not useful, since it forces the programmer
    to put explicit specializations of functions into header files. We
    had a long email exchange with Portland Group people in the summer
    of 2002, who promised to review the matter. Unfortunately, the
    problem still exists in pgcc 4.1 as of June 2003, making pgcc
    still unusable to compile deal.II.
    </p>

  </body>
</html>
