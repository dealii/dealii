# $Id$
# $Name$
#
# Copyright (c) the deal.II authors 2003

###############################
# Configured variables

D     = @DEAL2_DIR@
include $D/common/Make.global_options



html: deal.tag

private:
	perl -pi -e 's/(EXTRACT_PRIVATE\s*=\s*)NO/$$1YES/;s/(INTERNAL_DOCS\s*=\s*)NO/$$1YES/;' options.dox
	$(MAKE) html

%.tag: %.dox
	@DOXYGEN@ $<

base.tag: ../../base/include/*/*.h headers/base/*.h
lac.tag:  base.tag ../../lac/include/*/*.h headers/lac/*.h
deal.tag: lac.tag  ../../deal.II/include/*/*.h headers/deal.II/*.h

base:    base.tag
lac:     lac.tag
deal.II: deal.tag

# validate cross references. there are so many html files in these
# directories that we can just call
#    $(PERL) $D/common/scripts/validate-xrefs.pl deal.II/*.html
# as this leads to error messages of the kind "/usr/bin/perl: Argument 
# list too long". Instead, use a loop over all html files
validate-xrefs-%:
	@echo --- Validating xrefs in $(@:validate-xrefs-%=%)/ ---
	cd $(@:validate-xrefs-%=%) ; \
		for i in *.html ; do \
			$(PERL) $D/common/scripts/validate-xrefs.pl $i ; \
		done

validate-xrefs: validate-xrefs-base \
                validate-xrefs-lac  \
                validate-xrefs-deal.II


.PHONY: html private base lac deal.II \
	validate-xrefs \
	validate-xrefs-base \
        validate-xrefs-lac  \
        validate-xrefs-deal.II
